import{I as M}from"./index.a5003ade.js";import{F as T,u as W}from"./provide.9b1fd10c.js";import{R as P}from"./index.724ce894.js";import{d as j,a as p,t as c,c as A}from"./components.5cbda08a.js";import{t as y}from"./elements.27240eb2.js";import{d as E,_ as H,n as K,s as _,ab as L,f as b,h as C,l as X,F as q,ad as G,j as J,K as k,H as f,t as z}from"./elevation.f115f7e1.js";const O={modelValue:{type:[String,Number],default:0},count:{type:[String,Number],default:5},color:{type:String},icon:{type:String,default:"star"},emptyColor:{type:String},emptyIcon:{type:String,default:"star-outline"},size:{type:[String,Number]},gap:{type:[String,Number]},namespace:{type:String},half:{type:Boolean,default:!1},halfIcon:{type:String,default:"star-half-full"},disabled:{type:Boolean,default:!1},disabledColor:{type:String},readonly:{type:Boolean,default:!1},ripple:{type:Boolean,default:!0},rules:{type:Array},onChange:{type:Function},"onUpdate:modelValue":{type:Function}};const{n:u}=A("rate"),Q=E({name:"VarRate",components:{VarIcon:M,VarFormDetails:T},directives:{Ripple:P},props:O,setup(e){const{form:a,bindForm:V}=W(),{errorMessage:g,validateWithTrigger:N,validate:R,resetValidation:i}=j(),h=t=>{const{count:o,size:n,gap:l}=e;return{color:d(t).color,marginRight:t!==c(o)?y(l):0,width:y(n),height:y(n),borderRadius:"50%"}},v=t=>{const{type:o,color:n}=d(t);return{[u("content")]:!0,[u("--disabled")]:(a==null?void 0:a.disabled.value)||e.disabled,[u("--error")]:g.value,[u("--primary")]:o!=="empty"&&!n}},r=t=>{const{type:o}=d(t),{icon:n,halfIcon:l,emptyIcon:s}=e;return o==="full"?n:o==="half"?l:s},d=t=>{const{modelValue:o,disabled:n,disabledColor:l,color:s,half:$,emptyColor:w}=e;let m;return n||(a==null?void 0:a.disabled.value)?m=l:s&&(m=s),t<=c(o)?{type:"full",score:t,color:m}:$&&t<=c(o)+.5?{type:"half",score:t,color:m}:{type:"empty",score:t,color:n||(a==null?void 0:a.disabled.value)?l:w}},B=(t,o)=>{if(e.half){const{offsetWidth:n}=o.target;o.offsetX<=Math.floor(n/2)&&(t-=.5)}p(e["onUpdate:modelValue"],t)},F=()=>R(e.rules,c(e.modelValue)),D=()=>K(()=>N(["onChange"],"onChange",e.rules,e.modelValue)),U=(t,o)=>{const{readonly:n,disabled:l,onChange:s}=e;n||l||(a==null?void 0:a.disabled.value)||(a==null?void 0:a.readonly.value)||(B(t,o),p(s,t),D())},I=()=>{p(e["onUpdate:modelValue"],0),i()};return p(V,{reset:I,validate:F,resetValidation:i}),{errorMessage:g,formDisabled:a==null?void 0:a.disabled,formReadonly:a==null?void 0:a.readonly,getStyle:h,getClass:v,getIconName:r,handleClick:U,reset:I,validate:F,resetValidation:i,toSizeUnit:y,toNumber:c,n:u}}}),Y=["onClick"];function Z(e,a,V,g,N,R){const i=_("var-icon"),h=_("var-form-details"),v=L("ripple");return b(),C("div",{class:f(e.n("warp"))},[X("div",{class:f(e.n())},[(b(!0),C(q,null,G(e.toNumber(e.count),r=>J((b(),C("div",{key:r,style:k(e.getStyle(r)),class:f(e.getClass(r)),onClick:d=>e.handleClick(r,d)},[z(i,{class:f(e.n("content-icon")),"var-rate-cover":"",transition:0,namespace:e.namespace,name:e.getIconName(r),style:k({fontSize:e.toSizeUnit(e.size)})},null,8,["class","namespace","name","style"])],14,Y)),[[v,{disabled:e.formReadonly||e.readonly||e.formDisabled||e.disabled||!e.ripple}]])),128))],2),z(h,{"error-message":e.errorMessage},null,8,["error-message"])],2)}var S=H(Q,[["render",Z]]);S.install=function(e){e.component(S.name,S)};export{S as R};
